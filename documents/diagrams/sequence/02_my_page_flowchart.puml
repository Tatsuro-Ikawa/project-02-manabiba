@startuml
title マイページ初期化からマイページ作成までのフローチャート

start

:ユーザーがマイページにアクセス;

:AuthGuard認証チェック;

if (認証済み?) then (no)
  :ホームページにリダイレクト;
  stop
else (yes)
  :プロフィール情報取得;
  
  if (プロフィール存在?) then (yes)
    :PDCA情報初期化;
    :マイページ表示（ユーザー情報 + PDCA日記）;
    stop
  else (no)
    :マイページ作成画面表示;
    
    if (「マイページを作成」ボタン押下?) then (no)
      :ホームページに戻る;
      stop
    else (yes)
      :プロフィール作成モーダル表示;
      :ユーザー情報入力;
      
      if (「作成する」ボタン押下?) then (no)
        :モーダルを閉じる;
        :マイページ作成画面に戻る;
      else (yes)
        :ローディング画面表示;
        note right: 「マイページを作成中...」
        
        :Firestoreにプロフィール保存;
        
        :完了画面表示;
        note right: 「マイページの作成が完了しました！」
        
        if (「マイページを表示」ボタン押下?) then (yes)
          :ページ再読み込み;
          :プロフィール情報再取得;
          :PDCA情報初期化;
          :マイページ表示（ユーザー情報 + PDCA日記）;
        else (no)
          :完了画面のまま;
        endif
      endif
    endif
  endif
endif

stop

@enduml
